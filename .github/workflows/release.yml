name: 'update'

on:
    repository_dispatch:
    workflow_dispatch:
    push:

jobs:
    gui:
        runs-on: ubuntu-latest
        steps:
            -   name: Checkout
                uses: actions/checkout@v2

            -   name: get latest tag
                id: latestrelease
                run: |
                    echo "::set-output name=version::$(curl -s https://api.github.com/repos/applejuicenet/gui-java/releases/latest | jq -r '.tag_name')"

            -   name: confirm tag
                run: |
                    echo ${{ steps.latestrelease.outputs.releasetag }}

            -   name: download and validate
                run: |
                    curl -L -s https://github.com/applejuicenet/gui-java/releases/download/${{ steps.latestrelease.outputs.version }}/AJCoreGUI.macOS.zip -o AJCoreGUI.macOS.zip
                    curl -L -s https://github.com/applejuicenet/gui-java/releases/download/${{ steps.latestrelease.outputs.version }}/AJCoreGUI.macOS.zip.sha256.txt -o AJCoreGUI.macOS.zip.sha256.txt
                    shasum -c AJCoreGUI.macOS.zip.sha256.txt

            -   name: get shasum
                id: latestshasum
                run: |
                    echo "::set-output name=hash::$(cat AJCoreGUI.macOS.zip.sha256.txt | awk '{print $1}')"

            -   name: confirm shasum
                run: |
                    echo ${{ steps.latestshasum.outputs.hash }}

#            -   uses: stefanzweifel/git-auto-commit-action@v4
#                with:
#                    commit_message: Update GUI to ${{ steps.latestrelease.outputs.releasetag }}
